@import './tokens.css';
@import 'tailwindcss';

@font-face {
	font-family: 'Atkinson';
	src: url('/fonts/atkinson-regular.woff') format('woff');
	font-weight: 400;
	font-style: normal;
	font-display: swap;
}

@font-face {
	font-family: 'Atkinson';
	src: url('/fonts/atkinson-bold.woff') format('woff');
	font-weight: 700;
	font-style: normal;
	font-display: swap;
}

@layer base {
	:root {
		color-scheme: light;
		accent-color: var(--color-accent);
	}

	*,
	*::before,
	*::after {
		box-sizing: border-box;
	}

	body {
		margin: 0;
		min-height: 100%;
		background: var(--color-bg-page);
		color: var(--color-text-primary);
		font-family: 'Atkinson', -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
		font-size: var(--font-size-base);
		line-height: var(--line-height-base);
		letter-spacing: 0.01em;
	}

	strong,
	b {
		color: var(--color-accent);
		font-weight: 600;
	}

	main {
		max-width: var(--layout-max-width);
		margin-inline: auto;
		padding: var(--space-8) var(--space-4);
	}

	img,
	picture,
	video {
		display: block;
		max-width: 100%;
		height: auto;
	}
}

@layer components {
	.prose {
		color: var(--color-text-primary);
		line-height: var(--line-height-base);
		font-size: clamp(1rem, 0.4vw + 0.95rem, 1.1rem);
		max-width: var(--measure);
		margin-inline: auto;
		display: grid;
		gap: var(--space-4);
	}

	.prose > *:first-child {
		margin-top: 0;
	}

	.prose > *:last-child {
		margin-bottom: 0;
	}

	.prose h1,
	.prose h2,
	.prose h3,
	.prose h4,
	.prose h5,
	.prose h6 {
		color: var(--color-text-primary);
		font-weight: 700;
		line-height: var(--line-height-tight);
		letter-spacing: 0;
		margin: 0;
	}

	.prose h1 {
		font-size: clamp(2.2rem, 4.3vw, 3.2rem);
		margin-bottom: var(--space-2);
	}

	.prose h2 {
		font-size: clamp(1.85rem, 3.3vw, 2.35rem);
		margin-top: var(--space-6);
		margin-bottom: var(--space-2);
	}

	.prose h3 {
		font-size: clamp(1.55rem, 2.6vw, 1.95rem);
		margin-top: var(--space-5);
		margin-bottom: var(--space-2);
	}

	.prose h4 {
		font-size: 1.25rem;
		margin-top: var(--space-5);
	}

	.prose p {
		margin: 0;
		color: var(--color-text-secondary);
		max-width: var(--measure);
	}

	.prose p + p {
		margin-top: var(--space-2);
	}

	.prose h1 + p,
	.prose h2 + p {
		margin-top: var(--space-2);
	}

	.prose a {
		color: var(--color-link);
		text-underline-offset: 0.2em;
	}

	.prose a:hover {
		color: var(--color-link-hover);
	}

	.prose strong {
		color: var(--color-accent);
	}

	.prose blockquote {
		margin: 0;
		padding: var(--space-3) var(--space-4);
		border-left: 4px solid var(--color-accent);
		background: rgba(var(--color-accent-rgb), 0.08);
		color: var(--color-text-secondary);
		border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
	}

	.prose ul,
	.prose ol {
		margin: 0;
		padding-left: var(--space-6);
		display: grid;
		gap: var(--space-2);
		color: var(--color-text-secondary);
		list-style-position: outside;
	}
	.prose ul { list-style-type: disc; }
	.prose ol { list-style-type: decimal; }

	.prose ul ul,
	.prose ul ol,
	.prose ol ul,
	.prose ol ol {
		margin-top: var(--space-2);
	}
	.prose ul ul { list-style-type: circle; }
	.prose ul ul ul { list-style-type: square; }

	.prose li::marker {
		color: var(--color-text-muted);
	}

	.prose code {
		font-family: "Fira Code", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
		font-size: 0.95em;
		background: var(--color-accent-soft);
		padding: 0.1em 0.4em;
		border-radius: var(--radius-sm);
		color: var(--color-accent-dark);
	}

	.prose pre {
		margin: 0;
		padding: var(--space-4);
		background: rgba(var(--color-text-primary-rgb), 0.08);
		border-radius: var(--radius-md);
		border: 1px solid var(--color-border-subtle);
		overflow-x: auto;
		font-size: 0.95em;
	}

	.prose pre code {
		background: transparent;
		padding: 0;
		color: inherit;
	}

	.prose hr {
		border: none;
		border-top: 1px solid rgba(var(--color-text-primary-rgb), 0.12);
		margin: var(--space-5) 0;
	}

	.prose table {
		width: 100%;
		border-collapse: collapse;
		font-size: 0.95rem;
		background: var(--color-bg-surface);
		border: 1px solid var(--color-border);
		border-radius: var(--radius-md);
		box-shadow: var(--shadow-soft);
	}

	.prose table thead {
		position: sticky;
		top: 0;
		z-index: 1;
	}

	.prose table tbody tr:nth-child(even) {
		background: color-mix(in srgb, var(--color-bg-surface) 82%, var(--color-bg-muted) 18%);
	}

	.prose table tbody tr:hover {
		background: color-mix(in srgb, var(--color-bg-surface) 75%, var(--color-accent-soft) 25%);
	}

	.prose thead {
		background: color-mix(in srgb, var(--color-accent-soft) 60%, transparent);
	}

	.prose th,
	.prose td {
		padding: 0.75em 1em;
		text-align: left;
		border-bottom: 1px solid var(--color-border-soft);
		white-space: normal;
		word-break: break-word;
		color: var(--color-text-secondary);
	}

	.prose tbody tr:last-child td {
		border-bottom: none;
	}

	.prose :where(thead th) {
		font-weight: 600;
		color: var(--color-text-primary);
	}

	@media (max-width: 48rem) {
		.prose table[data-card-mode='cards'] {
			display: block;
			border: none;
			background: transparent;
			box-shadow: none;
		}

		.prose table[data-card-mode='cards'] thead {
			display: none;
		}

		.prose table[data-card-mode='cards'] tbody {
			display: grid;
			gap: var(--space-3);
		}

		.prose table[data-card-mode='cards'] tbody tr {
			display: grid;
			gap: var(--space-3);
			padding: var(--space-3);
			border: 1px solid var(--color-border-subtle);
			border-radius: var(--radius-md);
			background: color-mix(in srgb, var(--color-bg-surface) 90%, white 10%);
			box-shadow: var(--shadow-soft);
		}

		.prose table[data-card-mode='cards'] tbody tr:nth-child(even) {
			background: color-mix(in srgb, var(--color-bg-surface) 82%, var(--color-bg-muted) 18%);
		}

		.prose table[data-card-mode='cards'] tbody tr:hover {
			background: color-mix(in srgb, var(--color-bg-surface) 72%, var(--color-accent-soft) 28%);
		}

		.prose table[data-card-mode='cards'] :where(th, td) {
			display: flex;
			align-items: flex-start;
			gap: var(--space-2);
			padding: 0;
			border: none;
			background: transparent;
		}

		.prose table[data-card-mode='cards'] :where(td, th) + :where(td, th) {
			margin-top: var(--space-2);
		}

		.prose table[data-card-mode='cards'] :where(td, th)::before {
			content: attr(data-label);
			flex: 0 0 3rem;
			max-width: 20%;
			font-weight: 600;
			color: var(--color-text-muted);
			font-size: var(--font-size-xs);
			letter-spacing: 0.08em;
			text-transform: uppercase;
			line-height: 1.4;
		}

		.prose table[data-card-mode='cards'] :where(td, th)[data-label='']::before {
			content: none;
			flex: 0;
		}

		.prose table[data-card-mode='cards'] .table-card-value {
			flex: 1 1 0%;
			min-width: 0;
			color: var(--color-text-secondary);
			line-height: var(--line-height-base);
		}

		.prose table[data-card-mode='cards'] .table-card-value > :where(p, div, span, strong, em, a, ul, ol, code, pre, blockquote) {
			margin: 0;
		}
	}

	.prose figure {
		margin: 0;
		display: grid;
		gap: var(--space-2);
	}

	.prose figcaption {
		font-size: var(--font-size-sm);
		color: var(--color-text-muted);
		text-align: center;
	}

	.prose .footnotes,
	.prose .footnote-list {
		margin: var(--space-6) 0 0;
		padding: var(--space-4);
		background: var(--color-bg-muted);
		border-radius: var(--radius-md);
		box-shadow: var(--shadow-soft);
		font-size: var(--font-size-sm);
		color: var(--color-text-secondary);
	}

	.prose .footnotes ol,
	.prose .footnote-list ol {
		padding-left: var(--space-4);
		display: grid;
		gap: var(--space-2);
	}

	.prose .footnote-ref,
	.prose .footnote-backref {
		color: var(--color-accent);
		text-decoration: none;
	}

	.markdown-alert {
		margin: var(--space-6) 0;
		padding: var(--space-4);
		border-left: 4px solid var(--color-accent);
		border-radius: 0 var(--radius-md) var(--radius-md) 0;
		background: var(--color-accent-soft);
		box-shadow: var(--shadow-soft);
		display: grid;
		gap: var(--space-2);
	}

	.markdown-alert .markdown-alert-title {
		display: flex;
		align-items: center;
		gap: var(--space-2);
		font-weight: 600;
		color: var(--color-accent-dark);
	}

	.markdown-alert-note {
		border-left-color: #8d7bd6;
		background: color-mix(in srgb, #8d7bd6 18%, var(--color-bg-surface));
	}

	.markdown-alert-tip {
		border-left-color: var(--color-success);
		background: color-mix(in srgb, var(--color-success) 18%, var(--color-bg-surface));
	}

	.markdown-alert-warning,
	.markdown-alert-important {
		border-left-color: var(--color-warning);
		background: color-mix(in srgb, var(--color-warning) 18%, var(--color-bg-surface));
	}

	.markdown-alert-caution {
		border-left-color: var(--color-danger);
		background: color-mix(in srgb, var(--color-danger) 15%, var(--color-bg-surface));
	}
}
