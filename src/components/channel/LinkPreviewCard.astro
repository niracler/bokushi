---
import type { LinkPreview } from "../../utils/telegram";

interface Props {
    preview: LinkPreview;
}

const { preview } = Astro.props;
---

<a href={preview.url} target="_blank" rel="noopener noreferrer"
   class="link-preview surface-card surface-card--compact surface-card--hover-border">
    {preview.imageUrl && (
        <div class="link-preview__image">
            <img src={preview.imageUrl} alt="" loading="lazy" />
        </div>
    )}
    <div class="link-preview__content">
        {preview.siteName && (
            <span class="link-preview__site">{preview.siteName}</span>
        )}
        {preview.title && (
            <h4 class="link-preview__title">{preview.title}</h4>
        )}
        {preview.description && (
            <p class="link-preview__desc">{preview.description}</p>
        )}
    </div>
</a>

<style>
.link-preview {
    display: flex;
    gap: var(--space-3);
    padding: var(--space-3);
    text-decoration: none;
    color: inherit;
    margin-top: var(--space-4);
}

.link-preview__image {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
    border-radius: var(--radius-md);
    overflow: hidden;
    background: var(--color-bg-muted);
}

.link-preview__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.link-preview__content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
}

.link-preview__site {
    font-size: var(--font-size-xs);
    color: var(--color-accent);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.link-preview__title {
    font-size: var(--font-size-sm);
    font-weight: 600;
    color: var(--color-text-primary);
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.link-preview__desc {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

@media (max-width: 480px) {
    .link-preview {
        flex-direction: column;
    }

    .link-preview__image {
        width: 100%;
        height: 160px;
    }
}
</style>
