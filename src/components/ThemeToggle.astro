---
interface Props {
    label?: string;
    class?: string;
    variant?: "header" | "mobile";
}

const {
    label = "切换主题模式",
    class: className = "",
    variant = "header",
} = (Astro.props as Props) ?? {};
---

<div
	class={`theme-toggle ${className}`}
	data-theme-toggle-root
	data-variant={variant}
>
	<button
		type="button"
		class="icon-btn icon-btn--sm icon-btn--square icon-btn--bordered focus-accent"
		data-theme-toggle
		data-theme-preference="system"
		aria-label={label}
		title={label}
	>
		<span class="sr-only" data-theme-toggle-label>{label}</span>
		<span aria-hidden="true" class="icon-container">
			<!-- System: Lucide sun-moon 图标 -->
			<svg
				data-icon="system"
				class="theme-icon"
				viewBox="0 0 24 24"
				fill="none"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round"
			>
				<path d="M12 2v2" />
				<path d="M14.837 16.385a6 6 0 1 1-7.223-7.222c.624-.147.97.66.715 1.248a4 4 0 0 0 5.26 5.259c.589-.255 1.396.09 1.248.715" />
				<path d="M16 12a4 4 0 0 0-4-4" />
				<path d="m19 5-1.256 1.256" />
				<path d="M20 12h2" />
			</svg>

			<!-- Light: Lucide sun 图标 -->
			<svg
				data-icon="light"
				class="theme-icon"
				viewBox="0 0 24 24"
				fill="none"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round"
			>
				<circle cx="12" cy="12" r="4" />
				<path d="M12 2v2" />
				<path d="M12 20v2" />
				<path d="m4.93 4.93 1.41 1.41" />
				<path d="m17.66 17.66 1.41 1.41" />
				<path d="M2 12h2" />
				<path d="M20 12h2" />
				<path d="m6.34 17.66-1.41 1.41" />
				<path d="m19.07 4.93-1.41 1.41" />
			</svg>

			<!-- Dark: Lucide moon 图标 -->
			<svg
				data-icon="dark"
				class="theme-icon"
				viewBox="0 0 24 24"
				fill="none"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round"
			>
				<path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401" />
			</svg>
		</span>
	</button>
</div>

<script>
	import { bindThemeToggles } from "../scripts/theme.ts";

	const container =
		document.currentScript?.previousElementSibling?.closest(
			"[data-theme-toggle-root]",
		) ?? document;

	bindThemeToggles(container);
</script>

<style>
	/* Dark mode overrides only - base styles are in global.css */
	:global(html[data-theme="dark"]) .theme-toggle [data-theme-toggle] {
		color: var(--color-text-muted);
	}

	:global(html[data-theme="dark"]) .theme-toggle [data-theme-toggle]:hover {
		color: var(--color-link-hover);
	}
</style>
